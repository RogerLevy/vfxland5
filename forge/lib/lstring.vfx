\ ------------------------------------------------------------------------------
\ Cell-counted strings
\ ------------------------------------------------------------------------------

: lcount ( lstr - addr len )
    dup cell+ swap @ ;

: lplace ( addr len lstr - )
    2dup ! cell+ swap move ;

: lappend ( addr len lstr - )
    >r
    r@ cell+ r@ @ +  ( addr len dest )
    over >r swap move r>
    r@ @ + r> ! ;

: lslurp ( fn-a fn-len - l$ )
    here -rot  2dup fsize , file, ;

: l$,  ( a len - )
    \ here -rot  
    dup cell+ allot here lplace 
    ; \ drop ;

: l$@+ ( a - a' l$ len - )
    lcount 2dup + -rot ;